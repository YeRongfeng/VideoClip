# 视频裁切工具 (VideoClip)

一个基于 Python 和 Tkinter 的图形化视频裁切工具，支持可视化选择裁切区域，实时预览裁切效果。

## 功能特性

- ✨ **可视化裁切**: 通过鼠标拖拽在视频预览界面直接选择裁切区域
- 🎥 **实时预览**: 支持拖拽进度条预览视频任意帧
- 📏 **精确控制**: 实时显示裁切区域的坐标和尺寸信息
- 🖼️ **预览功能**: 裁切前可以预览裁切效果
- 📱 **用户友好**: 简洁直观的图形界面，操作简单
- 🔄 **智能缩放**: 自动适应窗口大小，保持视频比例

## 系统要求

- Python 3.12 或更高版本
- Windows/macOS/Linux 操作系统

## 安装

### 使用 uv (推荐)

```bash
# 克隆项目
git clone https://github.com/YeRongfeng/VideoClip.git
cd VideoClip

# 安装依赖
uv install
```

### 使用 pip

```bash
# 克隆项目
git clone https://github.com/YeRongfeng/VideoClip.git
cd VideoClip

# 安装依赖
pip install opencv-python pillow
```

## 使用方法

### 启动程序

```bash
# 使用 uv
uv run python main.py

# 或者直接运行
python main.py
```

### 操作步骤

1. **选择视频文件**
   - 点击"浏览..."按钮选择要裁切的视频文件
   - 支持常见视频格式（MP4、AVI、MOV等）

2. **预览视频**
   - 拖动进度条查看视频的不同帧
   - 选择合适的帧进行裁切区域选择

3. **选择裁切区域**
   - 在视频预览区域按住鼠标左键拖拽选择裁切区域
   - 实时显示裁切区域的坐标和尺寸
   - 可以重复调整直到满意

4. **预览裁切效果**
   - 点击"预览裁切"按钮查看裁切后的效果
   - 确认无误后进行最终裁切

5. **执行裁切**
   - 点击"裁切视频"按钮开始处理
   - 程序会显示进度信息
   - 完成后自动保存到原文件同目录

## 界面说明

### 控制区域
- **视频文件**: 显示当前选择的视频文件路径
- **预览帧**: 滑动条控制当前预览的视频帧
- **裁切区域**: 显示选中区域的 X、Y 坐标
- **尺寸**: 显示选中区域的宽度和高度

### 操作按钮
- **预览裁切**: 在右侧窗口预览裁切后的效果
- **裁切视频**: 开始执行视频裁切操作
- **重置选择**: 清除当前选择的裁切区域

### 显示区域
- **左侧**: 原始视频预览，可在此选择裁切区域
- **右侧**: 裁切效果预览窗口

## 技术栈

- **Python**: 主要编程语言
- **Tkinter**: 图形用户界面框架
- **OpenCV**: 视频处理和计算机视觉库
- **PIL/Pillow**: 图像处理库
- **NumPy**: 数值计算库

## 项目结构

```
VideoClip/
├── main.py          # 主程序文件
├── pyproject.toml   # 项目配置文件
├── uv.lock         # 依赖锁定文件
└── README.md       # 项目说明文档
```

## 开发说明

### 主要类和方法

- `VideoCropper`: 主应用类
  - `browse_file()`: 文件选择功能
  - `load_video()`: 视频加载和初始化
  - `update_preview()`: 更新视频预览
  - `start_draw()`, `draw_rect()`, `stop_draw()`: 裁切区域选择
  - `preview_crop()`: 裁切效果预览
  - `start_cropping()`: 执行视频裁切

### 核心功能实现

1. **视频读取**: 使用 OpenCV 的 VideoCapture 读取视频文件
2. **界面显示**: 将 OpenCV 图像转换为 PIL 格式，再转为 Tkinter 可显示的格式
3. **区域选择**: 通过鼠标事件监听实现拖拽选择功能
4. **视频处理**: 使用 OpenCV 的 VideoWriter 输出裁切后的视频

## 注意事项

- 请确保有足够的磁盘空间存储输出视频
- 处理大视频文件时可能需要较长时间，请耐心等待
- 建议在处理前先使用预览功能确认裁切区域
- 输出文件会自动保存在原文件同目录下，文件名添加"_cropped"后缀

## 常见问题

**Q: 支持哪些视频格式？**
A: 支持 OpenCV 能够读取的所有格式，包括 MP4、AVI、MOV、MKV 等常见格式。

**Q: 裁切后的视频质量如何？**
A: 程序会保持原始视频的编码设置，确保输出质量与原视频相近。

**Q: 可以批量处理视频吗？**
A: 当前版本只支持单个视频处理，批量功能可能在后续版本中添加。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 更新日志

### v0.1.0
- 初始版本发布
- 实现基础的视频裁切功能
- 支持可视化区域选择
- 添加预览功能